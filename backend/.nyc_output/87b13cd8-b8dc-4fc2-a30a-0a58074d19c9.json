{"/Users/armintalaie/Files/temp/JungleCart/backend/dist/src/lambda/auth-lambda/index.js":{"path":"/Users/armintalaie/Files/temp/JungleCart/backend/dist/src/lambda/auth-lambda/index.js","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":32}},"2":{"start":{"line":4,"column":20},"end":{"line":4,"column":65}},"3":{"start":{"line":6,"column":0},"end":{"line":8,"column":2}},"4":{"start":{"line":7,"column":4},"end":{"line":7,"column":33}},"5":{"start":{"line":12,"column":4},"end":{"line":17,"column":5}},"6":{"start":{"line":13,"column":8},"end":{"line":13,"column":55}},"7":{"start":{"line":16,"column":8},"end":{"line":16,"column":41}},"8":{"start":{"line":18,"column":16},"end":{"line":18,"column":60}},"9":{"start":{"line":19,"column":21},"end":{"line":19,"column":83}},"10":{"start":{"line":20,"column":17},"end":{"line":20,"column":25}},"11":{"start":{"line":21,"column":4},"end":{"line":27,"column":5}},"12":{"start":{"line":22,"column":8},"end":{"line":22,"column":21}},"13":{"start":{"line":25,"column":8},"end":{"line":25,"column":46}},"14":{"start":{"line":26,"column":8},"end":{"line":26,"column":36}},"15":{"start":{"line":29,"column":0},"end":{"line":29,"column":40}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":18},"end":{"line":6,"column":19}},"loc":{"start":{"line":6,"column":41},"end":{"line":8,"column":1}},"line":6},"1":{"name":"authorizeLogin","decl":{"start":{"line":10,"column":15},"end":{"line":10,"column":29}},"loc":{"start":{"line":10,"column":37},"end":{"line":28,"column":1}},"line":10}},"branchMap":{"0":{"loc":{"start":{"line":21,"column":4},"end":{"line":27,"column":5}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":27,"column":5}},{"start":{"line":21,"column":4},"end":{"line":27,"column":5}}],"line":21}},"s":{"0":1,"1":1,"2":1,"3":1,"4":0,"5":3,"6":3,"7":1,"8":2,"9":2,"10":1,"11":1,"12":0,"13":1,"14":1,"15":1},"f":{"0":0,"1":3},"b":{"0":[0,1]},"inputSourceMap":{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../src/lambda/auth-lambda/index.ts"],"names":[],"mappings":";;;AAAA,kEAAwE;AAExE,oCAAoC;AACpC,OAAO,CAAC,OAAO,GAAG,KAAK,WAAW,KAAK;IACnC,OAAO,cAAc,CAAC,KAAK,CAAC,CAAC;AACjC,CAAC,CAAC;AAEF,WAAW;AACJ,KAAK,UAAU,cAAc,CAAC,KAAK;IACtC,IAAI,SAAS,CAAC;IACd,IAAI;QACA,SAAS,GAAG,KAAK,CAAC,OAAO,CAAC,cAAc,CAAC,KAAK,CAAC;KAClD;IAAC,OAAO,CAAC,EAAE;QACR,MAAM,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC;KACpC;IACD,MAAM,GAAG,GAAG,4CAA4C,CAAC;IAEzD,MAAM,QAAQ,GAAG,MAAM,gCAAoB,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,SAAS,CAAC,CAAC,CAAC;IACpE,MAAM,IAAI,GAAG,QAAiB,CAAC;IAC/B,IAAI,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;QACjB,OAAO,KAAK,CAAC;KAChB;SAAM;QACH,OAAO,CAAC,GAAG,CAAC,GAAG,SAAS,YAAY,CAAC,CAAC;QACtC,MAAM,IAAI,KAAK,CAAC,UAAU,CAAC,CAAC;KAC/B;AACL,CAAC;AAjBD,wCAiBC","sourcesContent":["import {SQLConnectionManager} from \"/opt/nodejs/node_modules/sql-layer\";\n\n// handles routing and sends request\nexports.handler = async function (event) {\n    return authorizeLogin(event);\n};\n\n// handlers\nexport async function authorizeLogin(event): Promise<any> {\n    let userEmail;\n    try {\n        userEmail = event.request.userAttributes.email;\n    } catch (e) {\n        throw new Error(\"Missing Email\");\n    }\n    const sql = \"SELECT email FROM dev.user WHERE email = ?\";\n\n    const response = await SQLConnectionManager.query(sql, [userEmail]);\n    const rows = response as any[];\n    if (rows.length > 0) {\n        return event;\n    } else {\n        console.log(`${userEmail} not in db`);\n        throw new Error(\"NOT USER\");\n    }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"13d02b9c2b2f3a71aadfab848ead1bf58fbd8088","contentHash":"9d09f2a112c7f320bb6c1283b911a67696cb90901f9db871f1a29f72613f702f"},"/Users/armintalaie/Files/temp/JungleCart/backend/dist/src/layer/sql-layer/sql-layer.js":{"path":"/Users/armintalaie/Files/temp/JungleCart/backend/dist/src/layer/sql-layer/sql-layer.js","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"2":{"start":{"line":3,"column":26},"end":{"line":3,"column":33}},"3":{"start":{"line":4,"column":15},"end":{"line":4,"column":52}},"4":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"5":{"start":{"line":6,"column":6},"end":{"line":6,"column":68}},"6":{"start":{"line":6,"column":51},"end":{"line":6,"column":63}},"7":{"start":{"line":8,"column":4},"end":{"line":8,"column":39}},"8":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"9":{"start":{"line":10,"column":26},"end":{"line":10,"column":33}},"10":{"start":{"line":11,"column":4},"end":{"line":11,"column":17}},"11":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"12":{"start":{"line":14,"column":4},"end":{"line":14,"column":72}},"13":{"start":{"line":16,"column":4},"end":{"line":16,"column":21}},"14":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"15":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"16":{"start":{"line":19,"column":31},"end":{"line":19,"column":42}},"17":{"start":{"line":20,"column":17},"end":{"line":20,"column":19}},"18":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"19":{"start":{"line":21,"column":21},"end":{"line":21,"column":141}},"20":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"21":{"start":{"line":21,"column":109},"end":{"line":21,"column":141}},"22":{"start":{"line":22,"column":4},"end":{"line":22,"column":36}},"23":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"24":{"start":{"line":25,"column":0},"end":{"line":25,"column":62}},"25":{"start":{"line":26,"column":0},"end":{"line":26,"column":76}},"26":{"start":{"line":27,"column":14},"end":{"line":27,"column":44}},"27":{"start":{"line":30,"column":18},"end":{"line":30,"column":20}},"28":{"start":{"line":32,"column":8},"end":{"line":32,"column":52}},"29":{"start":{"line":35,"column":8},"end":{"line":35,"column":49}},"30":{"start":{"line":38,"column":8},"end":{"line":38,"column":50}},"31":{"start":{"line":41,"column":8},"end":{"line":41,"column":49}},"32":{"start":{"line":44,"column":8},"end":{"line":44,"column":38}},"33":{"start":{"line":45,"column":8},"end":{"line":47,"column":9}},"34":{"start":{"line":46,"column":12},"end":{"line":46,"column":80}},"35":{"start":{"line":48,"column":21},"end":{"line":48,"column":54}},"36":{"start":{"line":49,"column":23},"end":{"line":49,"column":54}},"37":{"start":{"line":50,"column":8},"end":{"line":52,"column":9}},"38":{"start":{"line":51,"column":12},"end":{"line":51,"column":88}},"39":{"start":{"line":54,"column":8},"end":{"line":54,"column":107}},"40":{"start":{"line":57,"column":8},"end":{"line":59,"column":9}},"41":{"start":{"line":58,"column":12},"end":{"line":58,"column":48}},"42":{"start":{"line":60,"column":8},"end":{"line":60,"column":58}},"43":{"start":{"line":63,"column":0},"end":{"line":63,"column":24}},"44":{"start":{"line":67,"column":8},"end":{"line":69,"column":9}},"45":{"start":{"line":68,"column":12},"end":{"line":68,"column":19}},"46":{"start":{"line":70,"column":8},"end":{"line":79,"column":11}},"47":{"start":{"line":82,"column":8},"end":{"line":92,"column":9}},"48":{"start":{"line":83,"column":12},"end":{"line":88,"column":13}},"49":{"start":{"line":84,"column":16},"end":{"line":84,"column":112}},"50":{"start":{"line":87,"column":16},"end":{"line":87,"column":65}},"51":{"start":{"line":91,"column":12},"end":{"line":91,"column":20}},"52":{"start":{"line":95,"column":8},"end":{"line":110,"column":11}},"53":{"start":{"line":96,"column":12},"end":{"line":97,"column":76}},"54":{"start":{"line":97,"column":16},"end":{"line":97,"column":76}},"55":{"start":{"line":98,"column":12},"end":{"line":105,"column":13}},"56":{"start":{"line":99,"column":16},"end":{"line":104,"column":19}},"57":{"start":{"line":100,"column":20},"end":{"line":103,"column":21}},"58":{"start":{"line":102,"column":24},"end":{"line":102,"column":75}},"59":{"start":{"line":106,"column":12},"end":{"line":109,"column":15}},"60":{"start":{"line":108,"column":16},"end":{"line":108,"column":78}},"61":{"start":{"line":113,"column":8},"end":{"line":115,"column":9}},"62":{"start":{"line":114,"column":12},"end":{"line":114,"column":34}},"63":{"start":{"line":118,"column":0},"end":{"line":118,"column":32}},"64":{"start":{"line":122,"column":8},"end":{"line":122,"column":19}},"65":{"start":{"line":126,"column":17},"end":{"line":126,"column":20}},"66":{"start":{"line":129,"column":17},"end":{"line":129,"column":20}},"67":{"start":{"line":132,"column":17},"end":{"line":132,"column":20}},"68":{"start":{"line":135,"column":17},"end":{"line":135,"column":20}},"69":{"start":{"line":137,"column":0},"end":{"line":137,"column":48}},"70":{"start":{"line":138,"column":0},"end":{"line":138,"column":52}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":74},"end":{"line":2,"column":75}},"loc":{"start":{"line":2,"column":96},"end":{"line":9,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":38},"end":{"line":6,"column":39}},"loc":{"start":{"line":6,"column":49},"end":{"line":6,"column":65}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":6},"end":{"line":9,"column":7}},"loc":{"start":{"line":9,"column":28},"end":{"line":12,"column":1}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":13,"column":80},"end":{"line":13,"column":81}},"loc":{"start":{"line":13,"column":95},"end":{"line":15,"column":1}},"line":13},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":5},"end":{"line":15,"column":6}},"loc":{"start":{"line":15,"column":20},"end":{"line":17,"column":1}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":18,"column":50},"end":{"line":18,"column":51}},"loc":{"start":{"line":18,"column":65},"end":{"line":24,"column":1}},"line":18},"6":{"name":"(anonymous_6)","decl":{"start":{"line":31,"column":4},"end":{"line":31,"column":5}},"loc":{"start":{"line":31,"column":31},"end":{"line":33,"column":5}},"line":31},"7":{"name":"(anonymous_7)","decl":{"start":{"line":34,"column":4},"end":{"line":34,"column":5}},"loc":{"start":{"line":34,"column":28},"end":{"line":36,"column":5}},"line":34},"8":{"name":"(anonymous_8)","decl":{"start":{"line":37,"column":4},"end":{"line":37,"column":5}},"loc":{"start":{"line":37,"column":29},"end":{"line":39,"column":5}},"line":37},"9":{"name":"(anonymous_9)","decl":{"start":{"line":40,"column":4},"end":{"line":40,"column":5}},"loc":{"start":{"line":40,"column":28},"end":{"line":42,"column":5}},"line":40},"10":{"name":"(anonymous_10)","decl":{"start":{"line":43,"column":4},"end":{"line":43,"column":5}},"loc":{"start":{"line":43,"column":23},"end":{"line":55,"column":5}},"line":43},"11":{"name":"(anonymous_11)","decl":{"start":{"line":56,"column":4},"end":{"line":56,"column":5}},"loc":{"start":{"line":56,"column":45},"end":{"line":61,"column":5}},"line":56},"12":{"name":"(anonymous_12)","decl":{"start":{"line":66,"column":4},"end":{"line":66,"column":5}},"loc":{"start":{"line":66,"column":48},"end":{"line":80,"column":5}},"line":66},"13":{"name":"(anonymous_13)","decl":{"start":{"line":81,"column":4},"end":{"line":81,"column":5}},"loc":{"start":{"line":81,"column":73},"end":{"line":93,"column":5}},"line":81},"14":{"name":"(anonymous_14)","decl":{"start":{"line":94,"column":4},"end":{"line":94,"column":5}},"loc":{"start":{"line":94,"column":22},"end":{"line":111,"column":5}},"line":94},"15":{"name":"(anonymous_15)","decl":{"start":{"line":95,"column":27},"end":{"line":95,"column":28}},"loc":{"start":{"line":95,"column":48},"end":{"line":110,"column":9}},"line":95},"16":{"name":"(anonymous_16)","decl":{"start":{"line":99,"column":40},"end":{"line":99,"column":41}},"loc":{"start":{"line":99,"column":51},"end":{"line":104,"column":17}},"line":99},"17":{"name":"(anonymous_17)","decl":{"start":{"line":106,"column":46},"end":{"line":106,"column":47}},"loc":{"start":{"line":106,"column":66},"end":{"line":109,"column":13}},"line":106},"18":{"name":"(anonymous_18)","decl":{"start":{"line":112,"column":4},"end":{"line":112,"column":5}},"loc":{"start":{"line":112,"column":22},"end":{"line":116,"column":5}},"line":112},"19":{"name":"(anonymous_19)","decl":{"start":{"line":121,"column":4},"end":{"line":121,"column":5}},"loc":{"start":{"line":121,"column":21},"end":{"line":123,"column":5}},"line":121}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":12,"column":3}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":57},"end":{"line":12,"column":2}}],"line":2},"1":{"loc":{"start":{"line":2,"column":57},"end":{"line":12,"column":2}},"type":"cond-expr","locations":[{"start":{"line":2,"column":74},"end":{"line":9,"column":1}},{"start":{"line":9,"column":6},"end":{"line":12,"column":1}}],"line":2},"2":{"loc":{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},"type":"if","locations":[{"start":{"line":3,"column":4},"end":{"line":3,"column":33}},{"start":{"line":3,"column":4},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},"type":"if","locations":[{"start":{"line":5,"column":4},"end":{"line":7,"column":5}},{"start":{"line":5,"column":4},"end":{"line":7,"column":5}}],"line":5},"4":{"loc":{"start":{"line":5,"column":8},"end":{"line":5,"column":85}},"type":"binary-expr","locations":[{"start":{"line":5,"column":8},"end":{"line":5,"column":13}},{"start":{"line":5,"column":18},"end":{"line":5,"column":84}}],"line":5},"5":{"loc":{"start":{"line":5,"column":18},"end":{"line":5,"column":84}},"type":"cond-expr","locations":[{"start":{"line":5,"column":34},"end":{"line":5,"column":47}},{"start":{"line":5,"column":50},"end":{"line":5,"column":84}}],"line":5},"6":{"loc":{"start":{"line":5,"column":50},"end":{"line":5,"column":84}},"type":"binary-expr","locations":[{"start":{"line":5,"column":50},"end":{"line":5,"column":63}},{"start":{"line":5,"column":67},"end":{"line":5,"column":84}}],"line":5},"7":{"loc":{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},"type":"if","locations":[{"start":{"line":10,"column":4},"end":{"line":10,"column":33}},{"start":{"line":10,"column":4},"end":{"line":10,"column":33}}],"line":10},"8":{"loc":{"start":{"line":13,"column":25},"end":{"line":17,"column":2}},"type":"binary-expr","locations":[{"start":{"line":13,"column":26},"end":{"line":13,"column":30}},{"start":{"line":13,"column":34},"end":{"line":13,"column":57}},{"start":{"line":13,"column":63},"end":{"line":17,"column":1}}],"line":13},"9":{"loc":{"start":{"line":13,"column":63},"end":{"line":17,"column":1}},"type":"cond-expr","locations":[{"start":{"line":13,"column":80},"end":{"line":15,"column":1}},{"start":{"line":15,"column":5},"end":{"line":17,"column":1}}],"line":13},"10":{"loc":{"start":{"line":18,"column":19},"end":{"line":24,"column":1}},"type":"binary-expr","locations":[{"start":{"line":18,"column":20},"end":{"line":18,"column":24}},{"start":{"line":18,"column":28},"end":{"line":18,"column":45}},{"start":{"line":18,"column":50},"end":{"line":24,"column":1}}],"line":18},"11":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":42}},{"start":{"line":19,"column":4},"end":{"line":19,"column":42}}],"line":19},"12":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":29}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":11}},{"start":{"line":19,"column":15},"end":{"line":19,"column":29}}],"line":19},"13":{"loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":4},"end":{"line":21,"column":141}},{"start":{"line":21,"column":4},"end":{"line":21,"column":141}}],"line":21},"14":{"loc":{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},"type":"if","locations":[{"start":{"line":21,"column":40},"end":{"line":21,"column":141}},{"start":{"line":21,"column":40},"end":{"line":21,"column":141}}],"line":21},"15":{"loc":{"start":{"line":21,"column":44},"end":{"line":21,"column":107}},"type":"binary-expr","locations":[{"start":{"line":21,"column":44},"end":{"line":21,"column":59}},{"start":{"line":21,"column":63},"end":{"line":21,"column":107}}],"line":21},"16":{"loc":{"start":{"line":45,"column":8},"end":{"line":47,"column":9}},"type":"if","locations":[{"start":{"line":45,"column":8},"end":{"line":47,"column":9}},{"start":{"line":45,"column":8},"end":{"line":47,"column":9}}],"line":45},"17":{"loc":{"start":{"line":50,"column":8},"end":{"line":52,"column":9}},"type":"if","locations":[{"start":{"line":50,"column":8},"end":{"line":52,"column":9}},{"start":{"line":50,"column":8},"end":{"line":52,"column":9}}],"line":50},"18":{"loc":{"start":{"line":50,"column":12},"end":{"line":50,"column":70}},"type":"binary-expr","locations":[{"start":{"line":50,"column":12},"end":{"line":50,"column":35}},{"start":{"line":50,"column":39},"end":{"line":50,"column":70}}],"line":50},"19":{"loc":{"start":{"line":57,"column":8},"end":{"line":59,"column":9}},"type":"if","locations":[{"start":{"line":57,"column":8},"end":{"line":59,"column":9}},{"start":{"line":57,"column":8},"end":{"line":59,"column":9}}],"line":57},"20":{"loc":{"start":{"line":67,"column":8},"end":{"line":69,"column":9}},"type":"if","locations":[{"start":{"line":67,"column":8},"end":{"line":69,"column":9}},{"start":{"line":67,"column":8},"end":{"line":69,"column":9}}],"line":67},"21":{"loc":{"start":{"line":81,"column":21},"end":{"line":81,"column":39}},"type":"default-arg","locations":[{"start":{"line":81,"column":34},"end":{"line":81,"column":39}}],"line":81},"22":{"loc":{"start":{"line":83,"column":12},"end":{"line":88,"column":13}},"type":"if","locations":[{"start":{"line":83,"column":12},"end":{"line":88,"column":13}},{"start":{"line":83,"column":12},"end":{"line":88,"column":13}}],"line":83},"23":{"loc":{"start":{"line":96,"column":12},"end":{"line":97,"column":76}},"type":"if","locations":[{"start":{"line":96,"column":12},"end":{"line":97,"column":76}},{"start":{"line":96,"column":12},"end":{"line":97,"column":76}}],"line":96},"24":{"loc":{"start":{"line":98,"column":12},"end":{"line":105,"column":13}},"type":"if","locations":[{"start":{"line":98,"column":12},"end":{"line":105,"column":13}},{"start":{"line":98,"column":12},"end":{"line":105,"column":13}}],"line":98},"25":{"loc":{"start":{"line":100,"column":20},"end":{"line":103,"column":21}},"type":"if","locations":[{"start":{"line":100,"column":20},"end":{"line":103,"column":21}},{"start":{"line":100,"column":20},"end":{"line":103,"column":21}}],"line":100},"26":{"loc":{"start":{"line":108,"column":16},"end":{"line":108,"column":77}},"type":"cond-expr","locations":[{"start":{"line":108,"column":24},"end":{"line":108,"column":58}},{"start":{"line":108,"column":61},"end":{"line":108,"column":77}}],"line":108},"27":{"loc":{"start":{"line":113,"column":8},"end":{"line":115,"column":9}},"type":"if","locations":[{"start":{"line":113,"column":8},"end":{"line":115,"column":9}},{"start":{"line":113,"column":8},"end":{"line":115,"column":9}}],"line":113}},"s":{"0":1,"1":8,"2":8,"3":8,"4":8,"5":8,"6":1,"7":8,"8":0,"9":0,"10":0,"11":1,"12":1,"13":0,"14":1,"15":1,"16":0,"17":1,"18":1,"19":1,"20":8,"21":8,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":2,"30":1,"31":1,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":5,"41":2,"42":5,"43":1,"44":1,"45":0,"46":1,"47":1,"48":1,"49":1,"50":0,"51":0,"52":3,"53":3,"54":0,"55":3,"56":3,"57":3,"58":2,"59":3,"60":3,"61":1,"62":1,"63":1,"64":3,"65":0,"66":1,"67":2,"68":0,"69":1,"70":1},"f":{"0":8,"1":1,"2":0,"3":1,"4":0,"5":1,"6":1,"7":2,"8":1,"9":1,"10":0,"11":5,"12":1,"13":1,"14":3,"15":3,"16":3,"17":3,"18":1,"19":3},"b":{"0":[1,1,1],"1":[1,0],"2":[8,0],"3":[8,0],"4":[8,8],"5":[0,8],"6":[8,0],"7":[0,0],"8":[1,1,1],"9":[1,0],"10":[1,1,1],"11":[0,1],"12":[1,1],"13":[1,0],"14":[8,0],"15":[8,8],"16":[0,0],"17":[0,0],"18":[0,0],"19":[2,3],"20":[0,1],"21":[0],"22":[1,0],"23":[0,3],"24":[3,0],"25":[2,1],"26":[1,2],"27":[1,0]},"inputSourceMap":{"version":3,"file":"sql-layer.js","sourceRoot":"","sources":["../../../../src/layer/sql-layer/sql-layer.ts"],"names":[],"mappings":"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","sourcesContent":["import * as mysql from \"mysql\";\nimport {MysqlError, Query} from \"mysql\";\nexport type handler = (event?) => Promise<{ statusCode: number, body: object | string }>;\ntype Dict<T> = { [key: string]: T };\n\n// A router to manage routes in the style of express\nexport class Router {\n\n    private route_table: Dict<Dict<handler>> = {};\n\n    public delete(resourcePath: string, func: handler) {\n        this.addRoute(resourcePath, 'DELETE', func);\n    }\n\n    public get(resourcePath: string, func: handler) {\n        this.addRoute(resourcePath, 'GET', func);\n    }\n\n    public post(resourcePath: string, func: handler) {\n        this.addRoute(resourcePath, 'POST', func);\n    }\n\n    public put(resourcePath: string, func: handler) {\n        this.addRoute(resourcePath, 'PUT', func);\n    }\n\n    public async route(event): Promise<{ statusCode: number, body: object | string }> {\n        console.log(this.route_table);\n        if (!event.requestContext) {\n            return {statusCode: 407, body: \"ROUTE - expected requestContext\"};\n        }\n\n        const path = event.requestContext.resourcePath;\n        const method = event.requestContext.httpMethod;\n\n        if (!this.route_table[path] || !this.route_table[path][method]) {\n            return {statusCode: 405, body: \"ROUTE - Invalid route: \" + path + method};\n        }\n\n        // calls the function assigned based on the path and method\n        return this.route_table[event.requestContext.resourcePath][event.requestContext.httpMethod](event);\n    }\n\n    private addRoute(resourcePath: string, httpMethod: string, func: handler) {\n        if (!this.route_table[resourcePath]) {\n            this.route_table[resourcePath] = {};\n        }\n\n        this.route_table[resourcePath][httpMethod] = func;\n    }\n}\n\nexport class SQLManager {\n    private connection: null | mysql.Connection;\n\n    private connectToDB(hostname: string, user: string, password: string, port: string): void {\n        if (this.connection?.state === 'connected') {\n            return;\n        }\n        this.connection = mysql.createConnection({\n                host: hostname,\n                user: user,\n                password: password,\n                port: Number(port),\n                multipleStatements: true,\n                connectTimeout: 60 * 60 * 1000,\n                timeout: 60 * 60 * 1000,\n                debug: false,\n            }\n        );\n    }\n\n    createConnection(useDefault=false, hostname?: string, user?: string, password?: string, port?: string): void {\n        try {\n            if (useDefault) {\n                this.connectToDB('sqldb.cyg4txabxn5r.us-west-2.rds.amazonaws.com', 'admin', 'password', '3306');\n            } else {\n                this.connectToDB(hostname!, user!, password!, port!);\n            }\n        } catch (e) {\n            throw (e as Error);\n        }\n    }\n\n    query(query: string, set?): Promise<Query | any[]> {\n        return new Promise((resolve, reject) => {\n            if (!this.connection)\n                return reject(new FailedDependencyError('Connection Null'));\n\n            if (this.connection.state !== 'connected') {\n                this.connection.connect((error: MysqlError) => {\n                    if (error) {\n                        // 599\n                        reject(new NetworkConnectTimeoutError(error.code));\n                    }\n                });\n            }\n\n            this.connection.query(query, set, (error, results) => {\n                // todo find types of query errors to return correct status code\n                error ? reject(new BadRequest(error.code)) : resolve(results);\n            });\n        });\n    }\n\n    closeConnection(): void {\n        if (this.connection) {\n            this.connection.end();\n        }\n    }\n}\n\n\n\nclass NetworkError extends Error {\n    statusCode: number;\n\n    constructor(msg: string) {\n        super(msg);\n    }\n}\n\nclass NotFoundError extends NetworkError {\n    statusCode = 404;\n}\n\nclass BadRequest extends NetworkError {\n    statusCode = 400;\n}\n\nclass NetworkConnectTimeoutError extends NetworkError {\n    statusCode = 599;\n}\n\nclass FailedDependencyError extends NetworkError {\n    statusCode = 424;\n}\n\nexport const SQLConnectionManager = new SQLManager();\nSQLConnectionManager.createConnection(true);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a3b7d7b14cd9081ea806c448f3e8b69da17e09f6","contentHash":"8737c3485c85765b8c97d9329c1723de76c3801ab39ecb59e0db427dda93f43f"},"/Users/armintalaie/Files/temp/JungleCart/backend/dist/src/lambda/products-lambda/index.js":{"path":"/Users/armintalaie/Files/temp/JungleCart/backend/dist/src/lambda/products-lambda/index.js","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":143}},"2":{"start":{"line":4,"column":20},"end":{"line":4,"column":65}},"3":{"start":{"line":5,"column":20},"end":{"line":5,"column":62}},"4":{"start":{"line":7,"column":15},"end":{"line":7,"column":39}},"5":{"start":{"line":8,"column":0},"end":{"line":8,"column":29}},"6":{"start":{"line":9,"column":0},"end":{"line":9,"column":48}},"7":{"start":{"line":10,"column":0},"end":{"line":10,"column":46}},"8":{"start":{"line":11,"column":0},"end":{"line":11,"column":49}},"9":{"start":{"line":12,"column":0},"end":{"line":12,"column":33}},"10":{"start":{"line":14,"column":0},"end":{"line":16,"column":2}},"11":{"start":{"line":15,"column":4},"end":{"line":15,"column":37}},"12":{"start":{"line":19,"column":4},"end":{"line":24,"column":5}},"13":{"start":{"line":20,"column":8},"end":{"line":23,"column":10}},"14":{"start":{"line":25,"column":17},"end":{"line":25,"column":27}},"15":{"start":{"line":26,"column":16},"end":{"line":26,"column":47}},"16":{"start":{"line":27,"column":4},"end":{"line":35,"column":8}},"17":{"start":{"line":28,"column":28},"end":{"line":31,"column":5}},"18":{"start":{"line":32,"column":27},"end":{"line":35,"column":5}},"19":{"start":{"line":37,"column":0},"end":{"line":37,"column":32}},"20":{"start":{"line":39,"column":4},"end":{"line":40,"column":70}},"21":{"start":{"line":40,"column":8},"end":{"line":40,"column":70}},"22":{"start":{"line":41,"column":15},"end":{"line":41,"column":28}},"23":{"start":{"line":42,"column":16},"end":{"line":42,"column":54}},"24":{"start":{"line":43,"column":4},"end":{"line":52,"column":8}},"25":{"start":{"line":44,"column":28},"end":{"line":47,"column":5}},"26":{"start":{"line":49,"column":27},"end":{"line":52,"column":5}},"27":{"start":{"line":54,"column":0},"end":{"line":54,"column":46}},"28":{"start":{"line":56,"column":4},"end":{"line":57,"column":71}},"29":{"start":{"line":57,"column":8},"end":{"line":57,"column":71}},"30":{"start":{"line":58,"column":15},"end":{"line":58,"column":28}},"31":{"start":{"line":59,"column":16},"end":{"line":59,"column":56}},"32":{"start":{"line":60,"column":4},"end":{"line":69,"column":8}},"33":{"start":{"line":61,"column":28},"end":{"line":64,"column":5}},"34":{"start":{"line":66,"column":27},"end":{"line":69,"column":5}},"35":{"start":{"line":71,"column":0},"end":{"line":71,"column":48}},"36":{"start":{"line":73,"column":4},"end":{"line":74,"column":82}},"37":{"start":{"line":74,"column":8},"end":{"line":74,"column":82}},"38":{"start":{"line":75,"column":4},"end":{"line":76,"column":96}},"39":{"start":{"line":76,"column":8},"end":{"line":76,"column":96}},"40":{"start":{"line":77,"column":17},"end":{"line":77,"column":32}},"41":{"start":{"line":78,"column":15},"end":{"line":78,"column":28}},"42":{"start":{"line":79,"column":16},"end":{"line":79,"column":55}},"43":{"start":{"line":80,"column":4},"end":{"line":89,"column":8}},"44":{"start":{"line":81,"column":28},"end":{"line":84,"column":5}},"45":{"start":{"line":86,"column":27},"end":{"line":89,"column":5}},"46":{"start":{"line":91,"column":0},"end":{"line":91,"column":54}},"47":{"start":{"line":93,"column":22},"end":{"line":93,"column":42}},"48":{"start":{"line":94,"column":18},"end":{"line":94,"column":34}},"49":{"start":{"line":95,"column":20},"end":{"line":95,"column":38}},"50":{"start":{"line":96,"column":4},"end":{"line":96,"column":41}},"51":{"start":{"line":98,"column":0},"end":{"line":98,"column":42}},"52":{"start":{"line":101,"column":4},"end":{"line":101,"column":25}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":14,"column":18},"end":{"line":14,"column":19}},"loc":{"start":{"line":14,"column":41},"end":{"line":16,"column":1}},"line":14},"1":{"name":"addProduct","decl":{"start":{"line":18,"column":15},"end":{"line":18,"column":25}},"loc":{"start":{"line":18,"column":33},"end":{"line":36,"column":1}},"line":18},"2":{"name":"(anonymous_2)","decl":{"start":{"line":28,"column":14},"end":{"line":28,"column":15}},"loc":{"start":{"line":28,"column":28},"end":{"line":31,"column":5}},"line":28},"3":{"name":"(anonymous_3)","decl":{"start":{"line":32,"column":15},"end":{"line":32,"column":16}},"loc":{"start":{"line":32,"column":27},"end":{"line":35,"column":5}},"line":32},"4":{"name":"deleteProductById","decl":{"start":{"line":38,"column":15},"end":{"line":38,"column":32}},"loc":{"start":{"line":38,"column":40},"end":{"line":53,"column":1}},"line":38},"5":{"name":"(anonymous_5)","decl":{"start":{"line":44,"column":14},"end":{"line":44,"column":15}},"loc":{"start":{"line":44,"column":28},"end":{"line":47,"column":5}},"line":44},"6":{"name":"(anonymous_6)","decl":{"start":{"line":49,"column":15},"end":{"line":49,"column":16}},"loc":{"start":{"line":49,"column":27},"end":{"line":52,"column":5}},"line":49},"7":{"name":"getProductInfoById","decl":{"start":{"line":55,"column":15},"end":{"line":55,"column":33}},"loc":{"start":{"line":55,"column":41},"end":{"line":70,"column":1}},"line":55},"8":{"name":"(anonymous_8)","decl":{"start":{"line":61,"column":14},"end":{"line":61,"column":15}},"loc":{"start":{"line":61,"column":28},"end":{"line":64,"column":5}},"line":61},"9":{"name":"(anonymous_9)","decl":{"start":{"line":66,"column":15},"end":{"line":66,"column":16}},"loc":{"start":{"line":66,"column":27},"end":{"line":69,"column":5}},"line":66},"10":{"name":"updateProductInfoById","decl":{"start":{"line":72,"column":15},"end":{"line":72,"column":36}},"loc":{"start":{"line":72,"column":44},"end":{"line":90,"column":1}},"line":72},"11":{"name":"(anonymous_11)","decl":{"start":{"line":81,"column":14},"end":{"line":81,"column":15}},"loc":{"start":{"line":81,"column":28},"end":{"line":84,"column":5}},"line":81},"12":{"name":"(anonymous_12)","decl":{"start":{"line":86,"column":15},"end":{"line":86,"column":16}},"loc":{"start":{"line":86,"column":27},"end":{"line":89,"column":5}},"line":86},"13":{"name":"getProductsInfo","decl":{"start":{"line":92,"column":15},"end":{"line":92,"column":30}},"loc":{"start":{"line":92,"column":38},"end":{"line":97,"column":1}},"line":92},"14":{"name":"validateProductInformation","decl":{"start":{"line":100,"column":9},"end":{"line":100,"column":35}},"loc":{"start":{"line":100,"column":42},"end":{"line":102,"column":1}},"line":100}},"branchMap":{"0":{"loc":{"start":{"line":19,"column":4},"end":{"line":24,"column":5}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":24,"column":5}},{"start":{"line":19,"column":4},"end":{"line":24,"column":5}}],"line":19},"1":{"loc":{"start":{"line":39,"column":4},"end":{"line":40,"column":70}},"type":"if","locations":[{"start":{"line":39,"column":4},"end":{"line":40,"column":70}},{"start":{"line":39,"column":4},"end":{"line":40,"column":70}}],"line":39},"2":{"loc":{"start":{"line":56,"column":4},"end":{"line":57,"column":71}},"type":"if","locations":[{"start":{"line":56,"column":4},"end":{"line":57,"column":71}},{"start":{"line":56,"column":4},"end":{"line":57,"column":71}}],"line":56},"3":{"loc":{"start":{"line":73,"column":4},"end":{"line":74,"column":82}},"type":"if","locations":[{"start":{"line":73,"column":4},"end":{"line":74,"column":82}},{"start":{"line":73,"column":4},"end":{"line":74,"column":82}}],"line":73},"4":{"loc":{"start":{"line":73,"column":8},"end":{"line":73,"column":42}},"type":"binary-expr","locations":[{"start":{"line":73,"column":8},"end":{"line":73,"column":22}},{"start":{"line":73,"column":26},"end":{"line":73,"column":42}}],"line":73},"5":{"loc":{"start":{"line":75,"column":4},"end":{"line":76,"column":96}},"type":"if","locations":[{"start":{"line":75,"column":4},"end":{"line":76,"column":96}},{"start":{"line":75,"column":4},"end":{"line":76,"column":96}}],"line":75}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":1,"13":0,"14":1,"15":1,"16":1,"17":0,"18":1,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":1,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1,"47":0,"48":0,"49":0,"50":0,"51":1,"52":1},"f":{"0":0,"1":1,"2":0,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1},"b":{"0":[0,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"inputSourceMap":{"version":3,"file":"index.js","sourceRoot":"","sources":["../../../../src/lambda/products-lambda/index.ts"],"names":[],"mappings":"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","sourcesContent":["import { Router}  from \"/opt/nodejs/node_modules/sql-layer\";\nimport {SQLConnectionManager} from \"../../layer/sql-layer/sql-layer\";\n\n// set routing\nconst router = new Router();\n\nrouter.post('/', addProduct);\nrouter.delete('/:productId', deleteProductById);\nrouter.get('/:productId', getProductInfoById);\nrouter.put('/:productId', updateProductInfoById);\nrouter.get('/', getProductsInfo);\n\n\n// handles routing and sends request\nexports.handler = async function (event) {\n    return await router.route(event);\n};\n\n// handlers\nexport async function addProduct(event): Promise<response> {\n    if (!validateProductInformation(event.body)) {\n        return {\n            statusCode: 422,\n            body: \"addProduct - Invalid product information\"\n        };\n    }\n\n    const prod = event.body;\n    const sql = `INSERT INTO dev.product SET ?`;\n\n    return SQLConnectionManager.query(sql, [prod])\n        .then((results) => ({\n            statusCode: 201,\n            body: results\n        }))\n        .catch((error) => ({\n            statusCode: error.statusCode,\n            body: error.message,\n        }));\n}\n\nexport async function deleteProductById(event): Promise<response> {\n    if (!event.body.id)\n        return {statusCode: 400, body: 'deleteProductById - No id'};\n\n    const id = event.body.id;\n    const sql = 'DELETE FROM dev.product WHERE id = ?';\n\n    return SQLConnectionManager.query(sql, [id])\n        .then((results) => ({\n            statusCode: 204,\n            body: results\n        }))\n        // todo check type of error if it is from invalid id (404) or connection error (599)\n        .catch((error) => ({\n            statusCode: error.statusCode,\n            body: error.message,\n        }));\n}\n\nexport async function getProductInfoById(event): Promise<response> {\n    if (!event.body.id)\n        return {statusCode: 400, body: 'getProductInfoById - No id'};\n\n    const id = event.body.id;\n    const sql = 'SELECT * FROM dev.product WHERE id = ?';\n\n    return query(sql, [id])\n        .then((results) => ({\n            statusCode: 200,\n            body: results\n        }))\n        // todo check type of error if it is from invalid id (404) or connection error (599)\n        .catch((error) => ({\n            statusCode: error.statusCode,\n            body: error.message,\n        }));\n}\n\nexport async function updateProductInfoById(event): Promise<response> {\n    if (!event.body.id || !event.body.info)\n        return {statusCode: 400, body: 'updateProductInfoById - No id or info'};\n    if (!validateProductInformation(event.body.info))\n        return {statusCode: 422, body: \"updateProductInfoById - Invalid product information\"};\n\n    const info = event.body.info;\n    const id = event.body.id;\n    const sql = 'UPDATE dev.product SET ? WHERE id = ?';\n\n    return SQLConnectionManager.query(sql, [info, id])\n        .then((results) => ({\n            statusCode: 200,\n            body: results\n        }))\n        // todo check type of error if it is from invalid id (404) or connection error (599)\n        .catch((error) => ({\n            statusCode: error.statusCode,\n            body: error.message,\n        }));\n}\n\nexport async function getProductsInfo(event): Promise<response> {\n    const searchOpt = event.body.searchOpt;\n    const order = event.body.order;\n    const pageOpt = event.body.pageOpt;\n    return {statusCode: 300, body: ''};\n}\n\n// todo implement\nfunction validateProductInformation(prod) {\n    return prod === prod;\n}\n\ntype response = {statusCode: number, body: object | string};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7e93c249aeaa6a6c8e91321f81512febf5b7c7bf","contentHash":"96eda718f17c5089d2cab9192fc786ea3b6339e966f27a77d8c5f99e24ee71ae"}}